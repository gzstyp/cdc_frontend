<meta charset="utf-8"/>
<style type="text/css">
    .welcome-container{
        height:calc(100vh - 176px);
        width:100%;
        display:flex;
        flex-direction:column;
        padding:6px;
        padding-bottom:0;
    }
    .container-row{
        width:100%;
        height:49.5%;
        display:flex;
        justify-content:space-between;
        margin-top:12px;
    }
    .container-card{
        padding:10px;
        width:49.5%;
        border-radius:10px;
        -moz-box-shadow:2px 2px 5px #c1bdbd;
        -webkit-box-shadow:2px 2px 5px #c1bdbd;
        box-shadow:2px 2px 5px #c1bdbd;
    }
</style>
<div class="row">
    <div class="col-xs-12">
        <div class="row">
            <div class="col-xs-12">
                <div class="welcome-container">
                    <div class="container-row">
                        <div class="container-card" style="display:flex;justify-content:space-between">
                            <div style="width:50%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:16px;">
                                <div style="padding:10px;color:#2F4554;width:100%;padding-left:30%;" id="environment_total">总采样数:0</div>
                                <div style="padding:10px;color:#61A0A8;width:100%;padding-left:30%;" id="environment_notest">未检测数:0</div>
                                <div style="padding:10px;color:#D48265;width:100%;padding-left:30%;" id="environment_negative">阴性数:0</div>
                                <div style="padding:10px;color:#C23531;width:100%;padding-left:30%;" id="environment_positive">阳性数:0</div>
                                <div style="padding:10px;color:#91C7AE;width:100%;padding-left:30%;" id="environment_pc">检测比例:0%</div>
                            </div>
                            <div id="environment" style="width:50%;height:100%;"></div>
                        </div>
                        <div class="container-card" style="display:flex;justify-content:space-between">
                            <div style="width:50%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:16px;">
                                <div style="padding:10px;color:#2F4554;width:100%;padding-left:30%;" id="employee_total">总采样数:0</div>
                                <div style="padding:10px;color:#61A0A8;width:100%;padding-left:30%;" id="employee_notest">未检测数:0</div>
                                <div style="padding:10px;color:#D48265;width:100%;padding-left:30%;" id="employee_negative">阴性数:0</div>
                                <div style="padding:10px;color:#C23531;width:100%;padding-left:30%;" id="employee_positive">阳性数:0</div>
                                <div style="padding:10px;color:#91C7AE;width:100%;padding-left:30%;" id="employee_pc">检测比例:0%</div>
                            </div>
                            <div id="employee" style="width:50%;height:100%;"></div>
                        </div>
                    </div>
                    <div class="container-row">
                        <div class="container-card" style="display:flex;justify-content:space-between">
                            <div style="width:50%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:16px;">
                                <div style="padding:10px;color:#2F4554;width:100%;padding-left:30%;" id="crowd_total_total">总采样数:0</div>
                                <div style="padding:10px;color:#61A0A8;width:100%;padding-left:30%;" id="crowd_total_notest">未检测数:0</div>
                                <div style="padding:10px;color:#C23531;width:100%;padding-left:30%;" id="crowd_total_positive">阳性数:0</div>
                                <div style="padding:10px;color:#D48265;width:100%;padding-left:30%;" id="crowd_total_pc">检测比例:0%</div>
                            </div>
                            <div id="crowd_total" style="width:50%;height:100%;"></div>
                        </div>
                        <div class="container-card">
                            <div id="crowdType" style="width:100%;height:100%;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    $(function(){
        var urlRoute = '/welcome/';/*请求controller层的url*/
        var urlGetData = urlRoute + 'getData';/*查看报表*/
        thisPage = {
            init : function(){
                this.getData();
                this.initDom();
            },
            initDom : function(){
                var data = {
                    positive : 0,
                    total : 0,
                    notest : 0,
                    negative : 0,
                    pc : 0
                }
                this.environment(data);
                this.employee(data);
                var _crowd = {
                    positive : 205,
                    total : 205,
                    notest : 0,
                    pc : 0
                }
                this.crowdTotal(_crowd);
                var dates = ['12-24','12-25','12-26','12-27','12-28','12-29','12-30'];
                var environments = [120, 132, 101, 134, 90, 230, 210];
                var employees = [220, 182, 191, 234, 290, 330, 310];
                var dailys = [150, 232, 201, 154, 190, 330, 410];
                this.crowdType(dates,environments,employees,dailys);
            },
            getData : function(){
                var _this = this;
                layerFn.queryGetHintResult(urlGetData,{},(data) =>{
                    if(data.code === AppKey.code.code200){
                        var environment = data.data.environment;
                        var employee = data.data.employee;
                        _this.environment(environment);
                        _this.employee(employee);
                    }
                });
            },
            environment : function(data){
                var environment = echarts.init(document.getElementById('environment'));
                environment.setOption({
                    title: {
                        text: '环境采样'
                    },
                    series : [
                        {
                            type: 'pie',    // 设置图表类型为饼图
                            radius: '55%',  // 饼图的半径，外半径为可视区尺寸（容器高宽中较小一项）的 55% 长度。
                            data:[          // 数据数组，name 为数据项名称，value 为数据项值
                                {value:data.positive, name:'阳性数'},
                                {value:data.total, name:'总采样数'},
                                {value:data.notest, name:'未检测数'},
                                {value:data.negative, name:'阴性数'},
                                {value:data.pc, name:'检测比例'}
                            ]
                        }
                    ]
                });
                $('#environment_total').text('总采样数:'+data.total);
                $('#environment_notest').text('未检测数:'+data.notest);
                $('#environment_negative').text('阴性数:'+data.negative);
                $('#environment_positive').text('阳性数:'+data.positive);
                $('#environment_pc').text('检测比例:'+data.pc);
            },
            employee : function(data){
                var employee = echarts.init(document.getElementById('employee'));
                employee.setOption({
                    title: {
                        text: '从业人员'
                    },
                    series : [
                        {
                            type: 'pie',
                            radius: '55%',
                            data:[
                                {value:data.positive, name:'阳性数'},
                                {value:data.total, name:'总采样数'},
                                {value:data.notest, name:'未检测数'},
                                {value:data.negative, name:'阴性数'},
                                {value:data.pc, name:'检测比例'}
                            ]
                        }
                    ]
                });
                $('#employee_total').text('总采样数:'+data.total);
                $('#employee_notest').text('未检测数:'+data.notest);
                $('#employee_negative').text('阴性数:'+data.negative);
                $('#employee_positive').text('阳性数:'+data.positive);
                $('#employee_pc').text('检测比例:'+data.pc);
            },
            crowdTotal : function(data){
                var crowd_total = echarts.init(document.getElementById('crowd_total'));
                crowd_total.setOption({
                    title: {
                        text: '核酸日报'
                    },
                    series : [
                        {
                            type: 'pie',
                            radius: '55%',
                            data:[
                                {value:data.positive, name:'阳性数'},
                                {value:data.total, name:'总采样数'},
                                {value:data.notest, name:'未检测数'},
                                {value:data.pc, name:'检测比例'}
                            ]
                        }
                    ]
                });
                $('#crowd_total_total').text('总采样数:'+data.total);
                $('#crowd_total_notest').text('未检测数:'+data.notest);
                $('#crowd_total_positive').text('阳性数:'+data.positive);
                $('#crowd_total_pc').text('检测比例:'+data.pc);
            },
            crowdType : function(dates,environments,employees,dailys){
                var crowdType = echarts.init(document.getElementById("crowdType"));
                crowdOption = {
                    title: {
                        text: '分类采样'
                    },
                    tooltip: {
                        trigger: 'axis'
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    toolbox: {
                        feature: {
                            saveAsImage: {}
                        }
                    },
                    xAxis: {
                        type: 'category',
                        boundaryGap: false,
                        data: dates
                    },
                    yAxis: {
                        type: 'value'
                    },
                    series: [
                        {
                            name: '外环境',
                            type: 'line',
                            stack: '总量',
                            data: environments
                        },
                        {
                            name: '从业人员',
                            type: 'line',
                            stack: '总量',
                            data: employees
                        },
                        {
                            name: '核酸日报',
                            type: 'line',
                            stack: '总量',
                            data: dailys
                        }
                    ]
                };
                crowdType.setOption(crowdOption);
            }
        };
        thisPage.init();
    });
</script>