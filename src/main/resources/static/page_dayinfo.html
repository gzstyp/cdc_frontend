<meta charset="utf-8"/>
<style type="text/css">
    a:link,a:visited,a:hover,a:active{
        text-decoration: none;
        outline:none;
        color:#1a1a1a;
    }
    li{
        list-style:none;
    }
</style>
<div class="row">
    <div class="col-xs-12">
        <div class="row">
            <div class="col-xs-12" style="display:flex;justify-content:center;">
                <div style="display:flex;flex-direction:column;width:786px;padding:10px 40px;border:1px solid #d0d0d0;margin-top:4px;">
                    <div style="width:100%;display:flex;justify-content:left;margin-top:10px;">
                        <table class="no-border" style="">
                            <tr>
                                <td class="hidden-480" style="padding: 0px 6px;">
                                    登记日期
                                </td>
                                <td>
                                    <div class="input-group">
                                        <input type="text" id="sampling_date_start" class="form-control search-query date-picker" placeholder="起始日期" style="width:86px;" data-date-format="yyyy-mm-dd"/>
                                    </div>
                                </td>
                                <td style="padding-left:4px;">
                                    至
                                </td>
                                <td style="padding-left:4px;">
                                    <div class="input-group">
                                        <input type="text" id="sampling_date_end" class="form-control search-query date-picker" placeholder="结束日期" style="width:86px;" data-date-format="yyyy-mm-dd"/>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div style="width:100%;display:flex;justify-content:left;margin-top:10px;">
                        <table class="no-border" style="display:inline">
                            <tr>
                                <td class="areaSelectText" style="padding: 0px 6px;">
                                    区域位置
                                </td>
                                <td class="areaSelectText">
                                    <div class="input-group">
                                        <div id="group_day"></div>
                                    </div>
                                </td>
                                <td style="padding-left:2px;">
                                    <div class="input-group">
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-inverse btn-white" id="btnSearch" permission='dailyDetails_btn_getView' style="display:none;">
                                            <span class="fa fa-eye bigger-110"></span>
                                            查看
                                        </button>
                                    </span>
                                    </div>
                                </td>
                                <td>
                                    <div class="input-group">
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-inverse btn-white" id="btnExport" permission='dailyDetails_btn_export' style="display:none;">
                                            <span class="fa fa-download"></span>
                                            导出
                                        </button>
                                    </span>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <div style="width:100%;display:flex;font-size:18px;font-weight:bold;justify-content:center;margin-top:10px;">贵阳市核酸筛查情况小结</div>
                    <div style="width:100%;display:flex;font-size:16px;line-height:1.6;margin-top:10px;font-weight:600">
                        <div>
                            2020年07月01日-2021年01月01日，累计核酸采集XX人，检测XX人，检测阳性XX人。
                        </div>
                    </div>
                    <div style="width:100%;display:flex;font-size:16px;line-height:1.6;margin-top:10px;font-weight:600">
                        <div>
                            2021年01月01日，贵阳市核酸采集XX人，检测XX人，检测阳性XX人。
                        </div>
                    </div>
                    <div style="width:100%;display:flex;font-size:16px;line-height:1.6;margin-top:10px;color:#f00">
                        <div>
                            一、应检尽检人群核酸情况
                        </div>
                    </div>
                    <div style="width:100%;display:flex;font-size:16px;line-height:1.6;margin-top:10px;font-weight:600">
                        <div>
                            1、2020年07月01日-2021年01月01日，贵阳市累计采样XX人，累计检测XX人，累计检测阳性XX人。
                        </div>
                    </div>
                    <div style="width:100%;display:flex;font-size:14px;line-height:1.6;margin-top:10px;">
                        <div>
                            密切接触者：采样XX人，检测XX人；境外入境人员：采样XX人，检测XX人；中高风险地区来黔人员：采样XX人，检测XX人；湖北来黔人员：采样796人，检测1037人；发热门诊就诊患者：采样XX人，检测XX人；新住院病人：采样XX人，检测XX人；陪护人员：采样XX人，检测XX人；医疗机构工作人员：采样XX人，检测XX人；口岸检疫和边防检查人员：采样XX人，检测XX人；监所工作人员：采样XX人，检测XX人；社会福利养老机构工作人员：采样XX人，检测4人；外省返黔师生：采样XX人，检测XX人；从事进口冷冻、冷藏肉、禽、水产品的交易、销售、搬运、运输、加工等工作的冷库、农贸批发市场、农贸市场、超市工作人员：采样XX人，检测XX人；从事非进口冷冻、冷藏肉、禽、水产品的交易、销售、搬运、运输、加工等工作的农贸市场及超市工作人员：采样XX人，检测XX人；快递、外卖服务人员：采样XX人，检测XX人；交通驾驶人员：采样XX人，检测XX人；集中隔离点工作服务人员：采样XX人，检测XX人；其他"应检尽检"人群：采样XX人，检测XX人；未发现阳性检测人员。
                        </div>
                    </div>
                    <div style="width:100%;display:flex;font-size:16px;line-height:1.6;margin-top:10px;font-weight:600">
                        <div>
                            2、2021年01月01日贵阳市采样XX人，检测XX人，检测阳性XX人。
                        </div>
                    </div>
                    <div style="width:100%;display:flex;font-size:14px;line-height:1.6;margin-top:10px;">
                        <div>
                            密切接触者：采样XX人，检测XX人；境外入境人员：采样XX人，检测XX人；中高风险地区来黔人员：采样XX人，检测XX人；发热门诊就诊患者：采样XX人，检测XX人；新住院病人：采样XX人，检测XX人；陪护人员：采样XX人，检测XX人；医疗机构工作人员：采样XX人，检测XX人；口岸检疫和边防检查人员：采样XX人，检测XX人；监所工作人员：采样XX人，检测XX人；社会福利养老机构工作人员：采样XX人，检测XX人；外省返黔师生：采样XX人，检测XX人；从事进口冷冻、冷藏肉、禽、水产品的交易、销售、搬运、运输、加工等工作的冷库、农贸批发市场、农贸市场、超市工作人员：采样XX人，检测XX人；从事非进口冷冻、冷藏肉、禽、水产品的交易、销售、搬运、运输、加工等工作的农贸市场及超市工作人员：采样XX人，检测XX人；快递、外卖服务人员：采样XX人，检测XX人；交通驾驶人员：采样XX人，检测XX人；集中隔离点工作服务人员：采样XX人，检测XX人；其他"应检尽检"人群：采样XX人，检测XX人；未发现阳性检测人员。
                        </div>
                    </div>
                    <div style="width:100%;display:flex;font-size:16px;line-height:1.6;margin-top:10px;color:#f00">
                        <div>
                            二、愿检尽检人群核酸情况
                        </div>
                    </div>
                    <div style="width:100%;display:flex;font-size:16px;line-height:1.6;margin-top:10px;font-weight:600">
                        <div>
                            1、2020年07月01日-2021年01月01日，贵阳市累计采样XX人，累计检测XX人，累计检测阳性0人。
                        </div>
                    </div>
                    <div style="width:100%;display:flex;font-size:14px;line-height:1.6;margin-top:10px;">
                        <div>
                            机关事业单位人员：采样XX人，检测XX人；企业人员：采样XX人，检测XX人；服务行业人员：采样XX人，检测XX人；其他人员：采样XX人，检测XX人；"愿检尽检"人群合计：采样XX人，检测XX人；未发现阳性检测人员。
                        </div>
                    </div>
                    <div style="width:100%;display:flex;font-size:16px;line-height:1.6;margin-top:10px;font-weight:600">
                        <div>
                            2、2021年01月01日贵阳市采样XX人，检测XX人，检测阳性0人。
                        </div>
                    </div>
                    <div style="width:100%;display:flex;font-size:14px;line-height:1.6;margin-top:10px;">
                        <div>
                            机关事业单位人员：采样XX人，检测XX人；企业人员：采样XX人，检测XX人；服务行业人员：采样XX人，检测XX人；其他人员：采样XX人，检测XX人；"愿检尽检"人群合计：采样XX人，检测XX人；未发现阳性检测人员。
                        </div>
                    </div>
                    <div style="width:100%;display:flex;font-size:14px;justify-content:end;margin-top:10px;" id="todayDate">2020年11月24日</div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $(function(){
        var urlRoute = '/dailyDetails/';/*请求controller层的url*/
        var urlQueryPermissions = urlRoute + 'queryPermissions';
        var urlQueryAreaSelect = urlRoute + 'queryAreaSelect';/*获取区域数据*/
        var urlExportExcel = urlRoute + 'queryExportWord';/*导出Excel*/
        var urlQueryExportData = urlRoute + 'getView';
        thisPage = {
            init : function(){
                winFn.initDate();
                this.initDom();
                this.addEvent();
                this.permissions();
                thisPage.viewReport();
            },
            addEvent : function(){
                this.btnEvent();
            },
            initDom(){
                $('#todayDate').html(winFn.getTodayDate());
                userArea.renderUserArea(urlQueryAreaSelect,'#group_day');
            },
            permissions : function(){
                layerFn.ajaxGetResult(urlQueryPermissions,{},(result)=>{
                    var {code,data} = result;
                    if(code === AppKey.code.code200){
                        for(var i=0;i<data.length;i++){
                            $("[permission='"+data[i]+"']").css({"display":"inline"});
                        }
                    }
                });
            },
            getSelectLabel : function(){
                this.showLabel(winFn.getDomValue('#sampling_date_start'),winFn.getDomValue('#sampling_date_end'));
            },
            showLabel : function(start,end){
                var date = "";
                if(start != null && end != null){
                    date = start +"至"+end;
                }
                if(start == null && end == null){
                    date = "截至"+winFn.getCurrentDate();
                }
                if(start == null && end != null){
                    date = "截至"+end;
                }
                if(start != null && end == null){
                    date = start+"至"+winFn.getCurrentDate();
                }
                $('#date_by').text(date);
            },
            btnEvent : function(){
                $('#btnSearch').on('click',function(){
                    thisPage.viewReport();
                });
                $('#btnExport').on('click',function(){
                    thisPage.exportExcel();
                });
            },
            viewReport : function(){
                var _this = this;
                var params = {
                    sampling_date_start : winFn.getDomValue('#sampling_date_start'),
                    sampling_date_end : winFn.getDomValue('#sampling_date_end')
                };
                layerFn.queryGetHintResult(urlQueryExportData,params,(data)=>{
                    _this.getSelectLabel();
                    if(data.code === AppKey.code.code200){
                        data = data.data;
                    }else{
                    }
                });
            },
            exportExcel : function(){
                var domProvince = '#group_day .clsProvince';
                var domCity = '#group_day .clsCity';
                var domCounty = '#group_day .clsCounty';
                var province_id = $(domProvince).val();
                var city_id = $(domCity).val();
                var county_id = $(domCounty).val();

                var url = urlExportExcel+'?&sampling_date_start='+$("#sampling_date_start").val()+
                '&sampling_date_end='+$("#sampling_date_end").val();

                if(province_id != undefined && province_id != ''){
                    url = url+'&province_id='+province_id;
                    url = url+'&province_text='+$(domProvince).find("option:selected").text();
                }
                if(city_id != undefined && city_id != ''){
                    url = url+'&city_id='+city_id;
                    url = url+'&city_text='+$(domCity).find("option:selected").text();
                }
                if(county_id != undefined && county_id != ''){
                    url = url+'&county_id='+county_id;
                    url = url+'&county_text='+$(domCounty).find("option:selected").text();
                }
                var areaKid = sessionStorage.getItem("areaKid");
                if(areaKid != null && areaKid != undefined){
                    url = url+'&areaKid='+areaKid;
                }

                layerFn.handleTop('请耐心等待,处理完成将会自动下载!',AppKey.code.code200);
                winFn.getPageHashToken(url);
            }
        };
        thisPage.init();
    });
</script>